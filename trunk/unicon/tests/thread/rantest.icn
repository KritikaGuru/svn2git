#
# talloc.icn -- thread allocation report test
#

global thrd

procedure main(argv)
   if not (&features == "concurrent threads") then
      stop("This program requires concurrent threads.")

   thrd:=[]

   if *argv>0 then
      n:=integer(argv[1]) | stop ("arg must be integer")
    else
      n:=1
  
   write("running ", n , " thread(s) please wait... ")
   t:=&now
   every i:= !n do put(thrd, thread talloc(d, i))
   every wait(!thrd)

   write("time:", &now-t, " seconds")
end

procedure talloc(id)
    every i := !10 do
	write("Thread ", id, " rand ", ?100)
end
    
