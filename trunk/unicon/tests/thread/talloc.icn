#
# talloc.icn -- thread allocation report test
#

global thrd

procedure main(argv)
   thrd:=[]

   if *argv>0 then
      n:=integer(argv[1]) | stop ("arg must be integer")
    else
      n:=1
  
   write("running ", n , " thread(s) please wait... ")
   t:=&now
   every i:= !n do put(thrd,thread talloc(i))
   every wait(!thrd)
   
   write("time:", &now-t, " seconds")
end

procedure talloc(id)
    every i := !1000 do 
	x := (? [list, table])(?100)

    write("Thread ", id, " allocated ", keyword("tallocated", thrd[id]))
end
    
