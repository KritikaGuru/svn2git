### rbasic.icn
### Paden Rumsey
### July 15, 2016

### a test designed to test basic concatenation of csets and strings
### in a regular expression environment. 

procedure main()
    while input := read() do {
	
	write("Basic character match")
	regx := <'z'>
	write(image(regx))
	match_string(input, regx)

	## the parenthesis gives us a syntax error at "at"
	
	write("Basic character alternation/concatenation")
	regx := <([f]|[c])"at">
	write(image(regx))
	match_string(input, regx)

	write("Basic character alternation/concatenation minus Parens")
	regx := <[f]|[c]"at">
	write(image(regx))
	match_string(input, regx)
	
	regx := <([s]"ally"|"ea"|"hore")>
	write("Basic string alternation/concatenation")
	write(image(regx))
	match_string(input, regx)

	write("Basic multiple string bracket \"{}\" test")
	regx := <"the"{3}>
	write(image(regx))
	match_string(input, regx)
    
	write("Basic one or more \"?\" test")
	regx := <"the"?>
	write(image(regx))
        match_string(input, regx)
	
	write("Basic single match \".\" test")
	regx := <"th"."s"|"e"|"t">
	write(image(regx))
	match_string(input, regx)
    }
end

procedure match_string(s, r)
    r := r -> out || Rem() -> remain
    write("The string is: ", s)
    if s ?? r then {
	write("The matched string is ", out, " the remainder is ", remain)
	}
    else
	write("The regex failed to match")
    write("\n")
end
